
<div class="min-h-screen bg-gray-100 py-12 px-6 lg:px-8">
  <div class="max-w-4xl mx-auto bg-white rounded-2xl shadow-lg overflow-hidden p-10">
    <div class="text-center mb-8">
      <h1 class="text-4xl font-extrabold text-teal-700">Souscription à un contrat automobile</h1>
      
    </div>

    <!-- Étape 1: Vérification CIN -->
    <div *ngIf="currentStep === 1" class="space-y-6">
      <h2 class="text-2xl font-semibold text-gray-800 border-b pb-2">Identification de l'assuré</h2>
      <div class="flex flex-col">
        <label class="text-gray-700 font-medium mb-2">Numéro CIN <span class="text-red-500">*</span></label>
        <div class="flex items-center border border-gray-300 p-3 rounded-lg bg-gray-50 focus-within:ring-2 focus-within:ring-teal-500">
          <mat-icon class="text-teal-700 mr-3">badge</mat-icon>
          <input type="text" [(ngModel)]="Cin" class="w-full bg-transparent focus:outline-none text-lg" placeholder="Entrez votre numéro CIN" required>
        </div>
        <span class="text-red-500 text-sm mt-1" *ngIf="cinError">{{ cinError }}</span>
      </div>
      <div class="text-center mt-6">
        <p class="text-gray-600">Vous n'avez pas encore de compte ?</p>
        <a href="#" class="text-teal-700 hover:text-teal-500 font-medium underline" (click)="redirectToRegistration()">Créer un compte maintenant</a>
      </div>
      <div class="flex justify-center mt-6">
        <button (click)="verifyCin()" class="bg-teal-700 text-white px-6 py-3 rounded-lg shadow-md hover:bg-teal-600 transition flex items-center text-lg font-semibold">
          Suivant <mat-icon class="ml-2">arrow_forward</mat-icon>
        </button>
      </div>
    </div>

    <!-- Étape 2: Formulaire principal -->
    <div *ngIf="currentStep === 2">
      <form [formGroup]="insuranceForm" (ngSubmit)="onSubmit()" class="space-y-6">
        <!-- Bonus Malus -->
        <div class="flex flex-col">
          <label class="text-gray-700 mb-1"><span class="text-red-500">*</span> Classe Bonus Malus</label>
          <div class="flex items-center border p-3 rounded-lg shadow-sm bg-gray-50">
            <mat-icon class="text-teal-800 mr-2">grade</mat-icon>
            <select formControlName="bonusMalus" class="w-full bg-transparent focus:outline-none">
              <option *ngFor="let classe of [1,2,3,4,5,6,7,8,9,10,11]" [value]="classe">{{ classe }}</option>
            </select>
          </div>
        </div>

        <!-- Partie Véhicule -->
        <h2 class="text-2xl font-semibold text-gray-700 mt-8 mb-4 border-b pb-2">Votre Véhicule</h2>
        <div formGroupName="vehicule" class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <!-- Type de véhicule -->
          <div class="flex flex-col">
            <label class="text-gray-700 mb-1"><span class="text-red-500">*</span> Type</label>
            <div class="flex items-center border p-3 rounded-lg shadow-sm bg-gray-50">
              <mat-icon class="text-teal-800 mr-2">category</mat-icon>
              <select formControlName="type" class="w-full bg-transparent focus:outline-none" required>
                <option value="Tourisme">Tourisme</option>
                <option value="Utilitaire">Utilitaire</option>
              </select>
            </div>
          </div>

          <!-- Marque -->
          <div class="flex flex-col">
            <label class="text-gray-700 mb-1"><span class="text-red-500">*</span> Marque</label>
            <div class="flex items-center border p-3 rounded-lg shadow-sm bg-gray-50">
              <mat-icon class="text-teal-800 mr-2">directions_car</mat-icon>
              <input type="text" formControlName="marque" class="w-full bg-transparent focus:outline-none" required>
            </div>
          </div>

          <!-- Modèle -->
          <div class="flex flex-col">
            <label class="text-gray-700 mb-1"><span class="text-red-500">*</span> Modèle</label>
            <div class="flex items-center border p-3 rounded-lg shadow-sm bg-gray-50">
              <mat-icon class="text-teal-800 mr-2">build</mat-icon>
              <input type="text" formControlName="model" class="w-full bg-transparent focus:outline-none" required>
            </div>
          </div>

          <!-- Immatriculation -->
          <div class="flex flex-col">
            <label class="text-gray-700 mb-1">
              <span class="text-red-500">*</span> Immatriculation
            </label>
            <div class="flex items-center border p-3 rounded-lg shadow-sm bg-gray-50">
              <mat-icon class="text-teal-800 mr-2">confirmation_number</mat-icon>
              <input type="text" formControlName="Imat" class="w-full bg-transparent focus:outline-none" required>
            </div>
            <span class="text-red-500 text-sm" *ngIf="insuranceForm.get('vehicule.Imat')?.invalid && insuranceForm.get('vehicule.Imat')?.touched">
              Le format doit être 4 chiffres + "TU" + 3 chiffres (ex: 1234TU567).
            </span>
          </div>

          <!-- Énergie -->
          <div class="flex flex-col">
            <label> Énergie</label>
            <div class="flex items-center border p-3 rounded-lg shadow-sm bg-gray-50">
              <mat-icon class="text-teal-800 mr-2">local_gas_station</mat-icon>
              <input type="text" formControlName="energie" class="w-full bg-transparent focus:outline-none" required>
            </div>
          </div>

          <!-- Nombre de places -->
          <div class="flex flex-col">
            <label class="text-gray-700 mb-1"><span class="text-red-500">*</span> Nombre de places</label>
            <div class="flex items-center border p-3 rounded-lg shadow-sm bg-gray-50">
              <mat-icon class="text-teal-800 mr-2">event_seat</mat-icon>
              <input type="number" formControlName="nbPlace" class="w-full bg-transparent focus:outline-none" required>
            </div>
          </div>

          <!-- Date de mise en circulation -->
          <div class="flex flex-col">
            <label class="text-gray-700 mb-1"><span class="text-red-500">*</span> Date de mise en circulation</label>
            <div class="flex items-center border p-3 rounded-lg shadow-sm bg-gray-50">
              <mat-icon class="text-teal-800 mr-2">calendar_today</mat-icon>
              <input type="date" formControlName="DPMC" class="w-full bg-transparent focus:outline-none" required>
            </div>
          </div>

          <!-- Cylindrée -->
          <div class="flex flex-col">
            <label class="text-gray-700 mb-1"><span class="text-red-500">*</span> Cylindrée</label>
            <div class="flex items-center border p-3 rounded-lg shadow-sm bg-gray-50">
              <mat-icon class="text-teal-800 mr-2">speed</mat-icon>
              <input type="text" formControlName="cylindree" class="w-full bg-transparent focus:outline-none" required>
            </div>
          </div>

          <!-- Charge utile -->
          <div class="flex flex-col">
            <label class="text-gray-700 mb-1"> Charge utile</label>
            <div class="flex items-center border p-3 rounded-lg shadow-sm bg-gray-50">
              <mat-icon class="text-teal-800 mr-2">weight</mat-icon>
              <input type="number" formControlName="chargeUtil" class="w-full bg-transparent focus:outline-none">
            </div>
          </div>

          <!-- Valeur à neuf -->
          <div class="flex flex-col">
            <label class="text-gray-700 mb-1"><span class="text-red-500">*</span> Valeur à neuf</label>
            <div class="flex items-center border p-3 rounded-lg shadow-sm bg-gray-50">
              <mat-icon class="text-teal-800 mr-2">money</mat-icon>
              <input type="number" formControlName="valeurNeuf" class="w-full bg-transparent focus:outline-none" required>
            </div>
          </div>

          <!-- Numéro de châssis -->
          <div class="flex flex-col">
            <label class="text-gray-700 mb-1"><span class="text-red-500">*</span> Numéro de châssis</label>
            <div class="flex items-center border p-3 rounded-lg shadow-sm bg-gray-50">
              <mat-icon class="text-teal-800 mr-2">confirmation_number</mat-icon>
              <input type="text" formControlName="numChassis" class="w-full bg-transparent focus:outline-none" required>
            </div>
          </div>

          <!-- Poids à vide -->
          <div class="flex flex-col">
            <label class="text-gray-700 mb-1"><span class="text-red-500">*</span> Poids à vide</label>
            <div class="flex items-center border p-3 rounded-lg shadow-sm bg-gray-50">
              <mat-icon class="text-teal-800 mr-2">fitness_center</mat-icon>
              <input type="number" formControlName="poidsVide" class="w-full bg-transparent focus:outline-none" required>
            </div>
          </div>

          <!-- Puissance -->
          <div class="flex flex-col">
            <label class="text-gray-700 mb-1"><span class="text-red-500">*</span> Puissance</label>
            <div class="flex items-center border p-3 rounded-lg shadow-sm bg-gray-50">
              <mat-icon class="text-teal-800 mr-2">fitness_center</mat-icon>
              <input type="number" formControlName="puissance" class="w-full bg-transparent focus:outline-none" required>
            </div>
          </div>
        </div>

        <!-- Partie Contrat -->
        <h2 class="text-2xl font-semibold text-gray-700 mt-8 mb-4 border-b pb-2">Renseignement</h2>
        <div formGroupName="contrat" class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <!-- Champ Pack choisi -->
          <div class="space-y-2">
            <label class="block text-lg font-semibold text-gray-700">Pack choisi <span class="text-red-500">*</span></label>
            <select formControlName="packChoisi" class="border p-3 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-teal-800">
              <option value="Pack1">Pack Essentille</option>
              <option value="Pack2">Pack Dommage et Collision</option>
              <option value="Pack3">Pack tous risques</option>
            </select>
          </div>

          <!-- Nature paiement -->
          <div class="space-y-2">
            <label class="block text-lg font-semibold text-gray-700">Nature de paiement <span class="text-red-500">*</span></label>
            <select formControlName="typePaiement" class="border p-3 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-teal-800">
              <option value="Annuel">Annuel</option>
              <option value="Semestriel">Semestriel</option>
            </select>
          </div>
          <!-- Nature de contrat -->
          <div class="space-y-2">
            <label class="block text-lg font-semibold text-gray-700">Nature de contrat <span class="text-red-500">*</span></label>
            <select formControlName="NatureContrat" class="border p-3 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-teal-800">
              <option value="Renouvelable">Renouvelable</option>
              <option value="Fermé">Fermé</option>
            </select>
          </div>
        </div>

        <div class="flex justify-between mt-12">
          <button
            type="button"
            (click)="previousStep()"
            class="bg-gray-300 text-gray-800 px-6 py-3 rounded-lg shadow-md hover:bg-gray-400 transition duration-300 flex items-center"
          >
            <mat-icon class="mr-2">arrow_back</mat-icon>
            Retour
          </button>

          <button
            type="submit"
            class="bg-teal-800 text-white px-6 py-3 rounded-lg shadow-md hover:bg-teal-700 transition duration-300 flex items-center"
          >
            SOUSCRIRE
            <mat-icon class="ml-2">check_circle</mat-icon>
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
